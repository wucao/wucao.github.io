
 <!DOCTYPE HTML>
<html lang="zh-CN">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
  
    <title>Java IPv6相关属性preferIPv4Stack、preferIPv6Addresses介绍 | 叉叉哥的BLOG</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="wucao">
    

    
    <meta name="description" content="IPv6背景介绍目前被广泛使用的IPv4，它的最大问题是网络地址资源有限。IPv4仅有32二进制位，满打满算也仅有不到43亿个IP地址，已经完全不能满足目前需求。IPv6有128二进制位，地址数量非常庞大。目前主流操作系统早已支持IPv6，Google、Facebook和Yahoo等网站也早已支持IPv6。2017年底中共中央办公厅、国务院办公厅印发《推进互联网协议第六版（IPv6）规模部署行动计">
<meta name="keywords" content="Java,IPv6">
<meta property="og:type" content="article">
<meta property="og:title" content="Java IPv6相关属性preferIPv4Stack、preferIPv6Addresses介绍">
<meta property="og:url" content="https://xxgblog.com/2019/02/17/java-ipv6-system-properties/index.html">
<meta property="og:site_name" content="叉叉哥的BLOG">
<meta property="og:description" content="IPv6背景介绍目前被广泛使用的IPv4，它的最大问题是网络地址资源有限。IPv4仅有32二进制位，满打满算也仅有不到43亿个IP地址，已经完全不能满足目前需求。IPv6有128二进制位，地址数量非常庞大。目前主流操作系统早已支持IPv6，Google、Facebook和Yahoo等网站也早已支持IPv6。2017年底中共中央办公厅、国务院办公厅印发《推进互联网协议第六版（IPv6）规模部署行动计">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="https://xxgblog.com/img/c3c91a63-6a81-410d-8ede-6904aa0d7d6c.jpg">
<meta property="og:image" content="https://xxgblog.com/img/f17a9d70-80a4-11e6-ae22-56b6b6499688.jpg">
<meta property="og:updated_time" content="2019-02-17T17:18:46.787Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Java IPv6相关属性preferIPv4Stack、preferIPv6Addresses介绍">
<meta name="twitter:description" content="IPv6背景介绍目前被广泛使用的IPv4，它的最大问题是网络地址资源有限。IPv4仅有32二进制位，满打满算也仅有不到43亿个IP地址，已经完全不能满足目前需求。IPv6有128二进制位，地址数量非常庞大。目前主流操作系统早已支持IPv6，Google、Facebook和Yahoo等网站也早已支持IPv6。2017年底中共中央办公厅、国务院办公厅印发《推进互联网协议第六版（IPv6）规模部署行动计">
<meta name="twitter:image" content="https://xxgblog.com/img/c3c91a63-6a81-410d-8ede-6904aa0d7d6c.jpg">

    
    <link rel="alternative" href="/atom.xml" title="叉叉哥的BLOG" type="application/atom+xml">
    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/xxg.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/xxg.jpg">
    
    <link rel="stylesheet" href="/css/style.css">
</head>
</html>
  <body>
    <header>
      
<div>
		
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="叉叉哥的BLOG">叉叉哥的BLOG</a></h1>
				<h2 class="blog-motto">Python毁一生，Java穷三代，两者皆不沾，必成高富帅！</h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="菜单">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">主页</a></li>
					
						<li><a href="/archives">归档</a></li>
					
						<li><a href="https://github.com/wucao">GitHub</a></li>
					
						<li><a href="/about">关于</a></li>
					
					<li>
 					
					<form class="search" action="//google.com/search" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="search" id="search" name="q" autocomplete="off" maxlength="20" placeholder="搜索">
						<input type="hidden" name="q" value="site:xxgblog.com">
					</form>
					
					</li>
				</ul>
			</ul></nav>
</div>

    </header>
    <div id="container">
      <div id="main" class="post" itemscope itemprop="blogPost">
  
	<article itemprop="articleBody"> 
		<header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2019/02/17/java-ipv6-system-properties/" title="Java IPv6相关属性preferIPv4Stack、preferIPv6Addresses介绍" itemprop="url">Java IPv6相关属性preferIPv4Stack、preferIPv6Addresses介绍</a>
  </h1>
  <p class="article-time">
    <time datetime="2019-02-17T03:14:16.000Z" itemprop="datePublished"> 发表于 2019-02-17</time>

  </p>
</header>

	<div class="article-content">
		
		<div id="toc" class="toc-article">
			<strong class="toc-title">文章目录</strong>
		
			<ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#IPv6背景介绍"><span class="toc-number">1.</span> <span class="toc-text">IPv6背景介绍</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Java对IPv6的支持"><span class="toc-number">2.</span> <span class="toc-text">Java对IPv6的支持</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Java-IPv6相关系统属性"><span class="toc-number">3.</span> <span class="toc-text">Java IPv6相关系统属性</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#java-net-preferIPv4Stack（默认值false）"><span class="toc-number">3.1.</span> <span class="toc-text">java.net.preferIPv4Stack（默认值false）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#java-net-preferIPv6Addresses（默认值false）"><span class="toc-number">3.2.</span> <span class="toc-text">java.net.preferIPv6Addresses（默认值false）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#参考资料"><span class="toc-number">4.</span> <span class="toc-text">参考资料</span></a></li></ol>
		
		</div>
		
		<h2 id="IPv6背景介绍"><a href="#IPv6背景介绍" class="headerlink" title="IPv6背景介绍"></a>IPv6背景介绍</h2><p>目前被广泛使用的IPv4，它的最大问题是网络地址资源有限。IPv4仅有32二进制位，满打满算也仅有不到43亿个IP地址，已经完全不能满足目前需求。IPv6有128二进制位，地址数量非常庞大。目前主流操作系统早已支持IPv6，Google、Facebook和Yahoo等网站也早已支持IPv6。2017年底中共中央办公厅、国务院办公厅印发<a href="http://www.gov.cn/zhengce/2017-11/26/content_5242389.htm" target="_blank" rel="noopener">《推进互联网协议第六版（IPv6）规模部署行动计划》</a>，推动国内IPv6的支持。目前已有大量国内网站和APP已经支持IPv6。未来数年将是IPv4到IPv6的过渡时期，IPv6和IPv4会并存，IPv6使用率也会逐渐提高。</p>
<h2 id="Java对IPv6的支持"><a href="#Java对IPv6的支持" class="headerlink" title="Java对IPv6的支持"></a>Java对IPv6的支持</h2><p>在<a href="https://docs.oracle.com/javase/8/docs/technotes/guides/net/ipv6_guide/index.html" target="_blank" rel="noopener">Networking IPv6 User Guide</a>文档中，介绍了Java对IPv6的支持情况：</p>
<blockquote>
<p>IPv6 in Java is transparent and automatic. Porting is not necessary; there is no need to recompile source files.</p>
</blockquote>
<p>Java中对IPv6的支持是透明的且自动化的，无需移植，也无需重新编译源码。相对于其他语言而言（例如C++），Java很好封装了IPv4和IPv6两种版本的不同，Java一般不需要在编写代码时关注IPv6如何支持，一个原本运行在IPv4环境的代码放到支持IPv6环境中一般也可以直接使用。</p>
<h2 id="Java-IPv6相关系统属性"><a href="#Java-IPv6相关系统属性" class="headerlink" title="Java IPv6相关系统属性"></a>Java IPv6相关系统属性</h2><p>由于Java封装了IPv4和IPv6的差异，在代码层面上不需要关注同时也无法设置使用IPv4还是IPv6，Java提供了<code>java.net.preferIPv4Stack</code>、<code>java.net.preferIPv6Addresses</code>两个系统属性，用于设置协议栈和地址族的选择。</p>
<p>这两个系统参数既可以在Java代码中设置：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">System.setProperty(<span class="string">"java.net.preferIPv4Stack"</span>, <span class="string">"true"</span>);</span><br></pre></td></tr></table></figure></p>
<p>也可以在启动时通过JVM参数设置：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-Djava.net.preferIPv4Stack=<span class="literal">true</span></span><br></pre></td></tr></table></figure></p>
<h3 id="java-net-preferIPv4Stack（默认值false）"><a href="#java-net-preferIPv4Stack（默认值false）" class="headerlink" title="java.net.preferIPv4Stack（默认值false）"></a>java.net.preferIPv4Stack（默认值false）</h3><p>官方文档解释：</p>
<blockquote>
<p>If IPv6 is available on the operating system, the underlying native socket will be an IPv6 socket. This allows Java applications to connect to, and accept connections from, both IPv4 and IPv6 hosts.</p>
</blockquote>
<p>当<code>java.net.preferIPv4Stack</code>为默认值false时，在支持IPv6的双栈系统上，使用Java的Socket会默认通过底层native方法创建一个IPv6 Socket，这个IPv6 Socket可以同时支持和IPv4或IPv6主机通信。如果设置为true，Java程序将无法使用IPv6进行网络通信，也就是仅支持IPv4。</p>
<p>例如，当TCP客户端<code>java.net.preferIPv4Stack</code>设置为true时，如果想创建一个host为IPv6的Socket，会抛出异常<code>java.net.SocketException: Protocol family unavailable</code>，设置为false时则程序可以正常运行：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">System.setProperty(<span class="string">"java.net.preferIPv4Stack"</span>, <span class="string">"true"</span>);</span><br><span class="line">Socket socket = <span class="keyword">new</span> Socket(<span class="string">"::1"</span>, <span class="number">80</span>); <span class="comment">// 访问IPv6地址::1（相当于IPv4的127.0.0.1）的80端口会抛出异常</span></span><br></pre></td></tr></table></figure></p>
<p>当TCP服务器<code>java.net.preferIPv4Stack</code>设置为true时，通过IPv6访问就会访问不通。</p>
<p>在正常情况下，Tomcat或者Jetty等Java服务器启动后，可以使用浏览器通过IPv4地址<a href="http://127.0.0.1:8080" target="_blank" rel="noopener">http://127.0.0.1:8080</a>或IPv6地址<a href="http://[::1]:8080" target="_blank" rel="noopener">http://[::1]:8080</a>两种方式访问，此时通过<code>lsof -i:8080</code>命令可以看到对应进程的Type为IPv6：<br><img src="/img/c3c91a63-6a81-410d-8ede-6904aa0d7d6c.jpg" alt="lsof命令"></p>
<p>如果加上JVM参数<code>-Djava.net.preferIPv4Stack=true</code>启动，此时通过<code>lsof -i:8080</code>命令可以看到对应进程的Type为IPv4：<br><img src="/img/f17a9d70-80a4-11e6-ae22-56b6b6499688.jpg" alt="lsof命令"><br>此时通过IPv6地址<a href="http://[::1]:8080" target="_blank" rel="noopener">http://[::1]:8080</a>将无法访问，仅可通过IPv4地址<a href="http://127.0.0.1:8080" target="_blank" rel="noopener">http://127.0.0.1:8080</a>访问。</p>
<h3 id="java-net-preferIPv6Addresses（默认值false）"><a href="#java-net-preferIPv6Addresses（默认值false）" class="headerlink" title="java.net.preferIPv6Addresses（默认值false）"></a>java.net.preferIPv6Addresses（默认值false）</h3><p>官方文档解释：</p>
<blockquote>
<p>By default, IPv4 addresses are preferred over IPv6 addresses, for example, when querying the name service (for instance, DNS service), IPv4 addresses would be returned ahead of IPv6 addresses. </p>
</blockquote>
<p>当<code>java.net.preferIPv6Addresses</code>为默认值false时，IPv4地址会优先使用，例如在DNS通过域名查询IP地址时，会优先使用IPv4地址，反之设为true，则会优先使用IPv6地址。</p>
<p>Google目前支持IPv4和IPv6，可以<code>host</code>命令查看域名<code>www.google.com</code>DNS解析的IPv4和IPv6地址：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">host www.google.com</span><br><span class="line">&gt; www.google.com has address 66.220.146.94</span><br><span class="line">&gt; www.google.com has IPv6 address 2404:6800:4008:803::2004</span><br></pre></td></tr></table></figure></p>
<p>默认情况下会优先使用IPv4地址：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">System.out.println(InetAddress.getByName(<span class="string">"www.google.com"</span>));</span><br></pre></td></tr></table></figure></p>
<p>输出：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">www.google.com/66.220.146.94</span><br></pre></td></tr></table></figure></p>
<p>当<code>java.net.preferIPv6Addresses</code>设置为true时会优先使用IPv6地址：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">System.setProperty(<span class="string">"java.net.preferIPv6Addresses"</span>, <span class="string">"true"</span>);</span><br><span class="line">System.out.println(InetAddress.getByName(<span class="string">"www.google.com"</span>));</span><br></pre></td></tr></table></figure></p>
<p>输出：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">www.google.com/2404:6800:4008:803:0:0:0:2004</span><br></pre></td></tr></table></figure></p>
<p>另外，通过<code>InetAddress.getLocalHost()</code>方法返回本机IP地址，最终返回的是IPv4还是IPv6地址，也会由<code>java.net.preferIPv6Addresses</code>的值来决定。</p>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ul>
<li><a href="https://docs.oracle.com/javase/8/docs/technotes/guides/net/ipv6_guide/index.html" target="_blank" rel="noopener">https://docs.oracle.com/javase/8/docs/technotes/guides/net/ipv6_guide/index.html</a></li>
</ul>
  
	</div>
		<footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/Java/">Java</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/Java/">Java</a><a href="/tags/IPv6/">IPv6</a>
  </div>

</div>



	<div class="article-share" id="share">
	
	  <div data-url="https://xxgblog.com/2019/02/17/java-ipv6-system-properties/" data-title="Java IPv6相关属性preferIPv4Stack、preferIPv6Addresses介绍 | 叉叉哥的BLOG" data-tsina class="share clearfix">
	  </div>
	
	</div>


</footer>

   	       
	</article>
	
<nav class="article-nav clearfix">
 
 <div class="prev">
 <a href="/2019/04/19/nginx-non-idempotent/" title="Nginx失败重试中的HTTP协议幂等问题: non_idempotent">
  <strong>上一篇：</strong><br>
  <span>
  Nginx失败重试中的HTTP协议幂等问题: non_idempotent</span>
</a>
</div>


<div class="next">
<a href="/2018/10/12/x-forwarded-for-header-trick/" title="利用X-Forwarded-For伪造客户端IP漏洞成因及防范">
 <strong>下一篇：</strong><br> 
 <span>利用X-Forwarded-For伪造客户端IP漏洞成因及防范
</span>
</a>
</div>

</nav>

	




<div id="gitalk-container" style="padding: 0 4%;"></div>

</div>  
      <div class="openaside"><a class="navbutton" href="#" title="显示侧边栏"></a></div>

  <div id="toc" class="toc-aside">
  <strong class="toc-title">文章目录</strong>
 
 <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#IPv6背景介绍"><span class="toc-number">1.</span> <span class="toc-text">IPv6背景介绍</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Java对IPv6的支持"><span class="toc-number">2.</span> <span class="toc-text">Java对IPv6的支持</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Java-IPv6相关系统属性"><span class="toc-number">3.</span> <span class="toc-text">Java IPv6相关系统属性</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#java-net-preferIPv4Stack（默认值false）"><span class="toc-number">3.1.</span> <span class="toc-text">java.net.preferIPv4Stack（默认值false）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#java-net-preferIPv6Addresses（默认值false）"><span class="toc-number">3.2.</span> <span class="toc-text">java.net.preferIPv6Addresses（默认值false）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#参考资料"><span class="toc-number">4.</span> <span class="toc-text">参考资料</span></a></li></ol>
 
  </div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="隐藏侧边栏"></a></div>
<aside class="clearfix">

  <div class="github-card">
<p class="asidetitle">微信公众号</p>
<div>
<img src="/img/WechatPublic.jpg" style="width: 100%;">
</div>
</div>


  
<div class="categorieslist">
	<p class="asidetitle">分类</p>
		<ul>
		
		  
			<li><a href="/categories/Android/" title="Android">Android<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/Jaeger/" title="Jaeger">Jaeger<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Java/" title="Java">Java<sup>22</sup></a></li>
		  
		
		  
			<li><a href="/categories/Jetty/" title="Jetty">Jetty<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/Maven/" title="Maven">Maven<sup>6</sup></a></li>
		  
		
		  
			<li><a href="/categories/MyBatis/" title="MyBatis">MyBatis<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Nginx/" title="Nginx">Nginx<sup>5</sup></a></li>
		  
		
		  
			<li><a href="/categories/Node-js/" title="Node.js">Node.js<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Redis/" title="Redis">Redis<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Spring-Cloud/" title="Spring Cloud">Spring Cloud<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Spring-Framework/" title="Spring Framework">Spring Framework<sup>6</sup></a></li>
		  
		
		  
			<li><a href="/categories/Struts-2/" title="Struts 2">Struts 2<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/XMPP/" title="XMPP">XMPP<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/异步网络编程/" title="异步网络编程">异步网络编程<sup>13</sup></a></li>
		  
		
		</ul>
</div>


  
<div class="tagslist">
	<p class="asidetitle">标签</p>
		<ul class="clearfix">
		
			
				<li><a href="/tags/Java/" title="Java">Java<sup>51</sup></a></li>
			
		
			
				<li><a href="/tags/Netty/" title="Netty">Netty<sup>13</sup></a></li>
			
		
			
				<li><a href="/tags/MINA/" title="MINA">MINA<sup>12</sup></a></li>
			
		
			
				<li><a href="/tags/Twisted/" title="Twisted">Twisted<sup>12</sup></a></li>
			
		
			
				<li><a href="/tags/TCP/" title="TCP">TCP<sup>12</sup></a></li>
			
		
			
				<li><a href="/tags/Python/" title="Python">Python<sup>12</sup></a></li>
			
		
			
				<li><a href="/tags/Spring-Framework/" title="Spring Framework">Spring Framework<sup>8</sup></a></li>
			
		
			
				<li><a href="/tags/Maven/" title="Maven">Maven<sup>8</sup></a></li>
			
		
			
				<li><a href="/tags/线程/" title="线程">线程<sup>5</sup></a></li>
			
		
			
				<li><a href="/tags/Nginx/" title="Nginx">Nginx<sup>5</sup></a></li>
			
		
			
				<li><a href="/tags/protobuf/" title="protobuf">protobuf<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/Jetty/" title="Jetty">Jetty<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/JavaScript/" title="JavaScript">JavaScript<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/Redis/" title="Redis">Redis<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/Android/" title="Android">Android<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/AES/" title="AES">AES<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/WebSocket/" title="WebSocket">WebSocket<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/MySQL/" title="MySQL">MySQL<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/XMPP/" title="XMPP">XMPP<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/Tigase/" title="Tigase">Tigase<sup>2</sup></a></li>
			
		
		</ul>
</div>


  <div class="linkslist">
  <p class="asidetitle">友情链接</p>
    <ul>
        
          <li>
            
            	<a href="http://lovecindywang.cnblogs.com/" target="_blank" title="朱晔的博客">朱晔的博客</a>
            
          </li>
        
          <li>
            
            	<a href="http://blackcoffee2016.github.io/" target="_blank" title="杨灿的博客">杨灿的博客</a>
            
          </li>
        
          <li>
            
            	<a href="http://opstrip.com/" target="_blank" title="石尧的博客">石尧的博客</a>
            
          </li>
        
          <li>
            
            	<a href="https://blog.csdn.net/eson_15" target="_blank" title="倪升武的博客">倪升武的博客</a>
            
          </li>
        
          <li>
            
            	<a href="http://blog.csdn.net/noaman_wgs" target="_blank" title="王根深的博客">王根深的博客</a>
            
          </li>
        
          <li>
            
            	<a href="https://www.cnblogs.com/jy107600" target="_blank" title="蒋宇的博客">蒋宇的博客</a>
            
          </li>
        
          <li>
            
            	<a href="http://youngforzy.top/" target="_blank" title="曾勇的博客">曾勇的博客</a>
            
          </li>
        
    </ul>
</div>

  <div class="rsspart">
	<a href="/atom.xml" target="_blank" title="rss">RSS 订阅</a>
</div>

</aside>
</div>
    </div>
    <footer><div id="footer">
	
	
	<div class="social-font">
		
		
		
		
		
		
		
		
		
		
	</div>
			
		

		<p style="text-align: center; font-size: 0.7em;">、
			<a href="https://beian.miit.gov.cn" target="_blank" style="color: white;">皖ICP备15002890号-2</a>
		</p>

		<p class="copyright">
		Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/wuchong/jacman" target="_blank" title="Jacman">Jacman</a> © 2022
		
		<a href="/about" target="_blank" title="wucao">wucao</a>
		

		</p>
</div>
</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/jquery.qrcode-0.12.0.min.js"></script>

<script type="text/javascript">
$(document).ready(function(){
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  
  $(window).resize(function(){
    getSize();
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else{
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
      
      $('#toc.toc-aside').css('display', 'none');
      
    }
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  c.click(function(){
    ta.css('display', 'block').addClass('fadeIn');
  });
  o.click(function(){
    ta.css('display', 'none');
  });
  $(window).scroll(function(){
    ta.css("top",Math.max(140,320-$(this).scrollTop()));
  });
});
</script>


<script type="text/javascript">
$(document).ready(function(){
  var $this = $('.share'),
      url = $this.attr('data-url'),
      encodedUrl = encodeURIComponent(url),
      title = $this.attr('data-title'),
      tsina = $this.attr('data-tsina'),
      description = $this.attr('description');
  var html = [
  '<div class="hoverqrcode clearfix"></div>',
  '<a class="overlay" id="qrcode"></a>',
  '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
  '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
  '<a href="#qrcode" class="article-share-qrcode" title="微信"></a>',
  '<a href="http://widget.renren.com/dialog/share?resourceUrl=' + encodedUrl + '&srcUrl=' + encodedUrl + '&title=' + title +'" class="article-share-renren" target="_blank" title="人人"></a>',
  '<a href="http://service.weibo.com/share/share.php?title='+title+'&url='+encodedUrl +'&ralateUid='+ tsina +'&searchPic=true&style=number' +'" class="article-share-weibo" target="_blank" title="微博"></a>',
  '<span title="Share to"></span>'
  ].join('');
  $this.append(html);

  $('.hoverqrcode').hide();

  var myWidth = 0;
  function updatehoverqrcode(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
    var qrsize = myWidth > 1024 ? 200:100;
    var options = {render: 'image', size: qrsize, fill: '#2ca6cb', text: url, radius: 0.5, quiet: 1};
    var p = $('.article-share-qrcode').position();
    $('.hoverqrcode').empty().css('width', qrsize).css('height', qrsize)
                          .css('left', p.left-qrsize/2+20).css('top', p.top-qrsize-10)
                          .qrcode(options);
  };
  $(window).resize(function(){
    $('.hoverqrcode').hide();
  });
  $('.article-share-qrcode').click(function(){
    updatehoverqrcode();
    $('.hoverqrcode').toggle();
  });
  $('.article-share-qrcode').hover(function(){}, function(){
      $('.hoverqrcode').hide();
  });
});
</script>








<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
<script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>
<script type="text/javascript">
const gitalk = new Gitalk({
  clientID: 'ce21dd1e4d8a2819290e',
  clientSecret: 'f0786f8810407db32800529b6533331d672c6eff',
  repo: 'xxg-blog-message-board',
  owner: 'wucao',
  admin: ['wucao'],
  id: location.pathname.split('/')[4]
});
$(document).ready(function() {
  gitalk.render('gitalk-container');
});
</script>





<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
});
</script>



<!-- Analytics Begin -->



<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?e6d1f421bbc9962127a50488f9ed37d1";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
</script>



<div style="height: 0px; overflow: hidden">
<script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_1254684152'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s23.cnzz.com/z_stat.php%3Fid%3D1254684152' type='text/javascript'%3E%3C/script%3E"));</script>
</div>


<!-- Analytics End -->

<!-- Totop Begin -->

	<div id="totop">
	<a title="返回顶部"><img src="/img/scrollup.png"></a>
	</div>
	<script src="/js/totop.js"></script>

<!-- Totop End -->

<!-- MathJax Begin -->
<!-- mathjax config similar to math.stackexchange -->


<!-- MathJax End -->

<!-- Tiny_search Begin -->

<!-- Tiny_search End -->

  </body>
</html>
